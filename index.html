<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Gieo Quáº» Äáº§u NÄƒm â€“ Vietschool</title>

<style>
body{
    margin:0;
    font-family:"Segoe UI",Tahoma,sans-serif;
    background:url("background-tet.png") no-repeat center center fixed;
    background-size:cover;
    color:#fff;
}
header{
    text-align:center;
    padding:20px;
    background:rgba(0,0,0,0.4);
}
header img{width:90px}
.container{
    max-width:950px;
    margin:30px auto;
    background:rgba(0,0,0,0.5);
    border-radius:16px;
    padding:25px;
}
input,select,button{
    width:100%;
    padding:10px;
    margin-top:8px;
    border-radius:8px;
    border:none;
}
button{
    background:#ffd700;
    font-weight:bold;
    cursor:pointer;
}
button:disabled{
    background:#ccc;
    cursor:not-allowed;
}
.fortune-box{
    width:180px;
    margin:20px auto;
}
.fortune-box img{width:100%}
.results li{
    background:rgba(255,255,255,.2);
    margin-bottom:8px;
    padding:10px;
    border-radius:6px;
}

/* ===== POPUP QUáºº ===== */
.overlay{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.85);
    display:none;
    align-items:center;
    justify-content:center;
    z-index:999;
    pointer-events:none;          /* ğŸ”‘ FIX CHáº¶N CLICK */
}
.overlay.show{
    display:flex;
    pointer-events:auto;
}
.popup{
    background:#fff;
    color:#8b0000;
    padding:30px;
    border-radius:16px;
    max-width:600px;
    text-align:center;
}
.popup p{
    font-size:22px;
}

/* ===== PHÃO HOA ===== */
.firework{
    position:fixed;
    width:12px;
    height:12px;
    background:gold;
    border-radius:50%;
    animation:boom 1s forwards;
}
@keyframes boom{
    to{
        transform:translateY(-200px) scale(2);
        opacity:0;
    }
}

/* ===== GV ===== */
table{
    background:#fff;
    color:#000;
    width:100%;
    border-collapse:collapse;
}
th,td{
    padding:6px;
    border:1px solid #ccc;
}
</style>
</head>

<body>

<header>
<img src="logo-vietschool.png">
<h2>TrÆ°á»ng LiÃªn cáº¥p THCS â€“ Tiá»ƒu há»c Vietschool Pandora</h2>
</header>

<div class="container">

<!-- ===== LOGIN HS ===== -->
<div id="login">
    <h3>ğŸŠ ÄÄƒng nháº­p gieo quáº» Ä‘áº§u nÄƒm ğŸŠ</h3>
    <input id="name" placeholder="Há» vÃ  tÃªn">
    <select id="class">
        <option value="">Chá»n lá»›p</option>
        <option>8V1</option>
        <option>8V2</option>
        <option>9V1</option>
    </select>
    <button id="loginBtn">VÃ o gieo quáº»</button>
</div>

<!-- ===== Há»ŒC SINH ===== -->
<div id="main" style="display:none">
    <p>
        ğŸ‘§ <b id="stuName"></b> â€“ ğŸ« <b id="stuClass"></b><br>
        ğŸŒ¸ <i id="wish"></i>
    </p>

    <div class="fortune-box">
        <img src="hop-que.png">
    </div>

    <button id="drawBtn">ğŸ´ Gieo quáº»</button>

    <ul class="results" id="results"></ul>
    <div id="submit" style="text-align:center;margin-top:15px"></div>
</div>

<hr>

<!-- ===== GIÃO VIÃŠN ===== -->
<button id="gvBtn">ğŸ” Cháº¿ Ä‘á»™ GiÃ¡o viÃªn</button>

<div id="gvPanel" style="display:none;margin-top:15px">
    <h3>ğŸ“‹ Danh sÃ¡ch há»c sinh Ä‘Ã£ gieo quáº»</h3>
    <table>
        <thead>
            <tr>
                <th>Há» tÃªn</th>
                <th>Lá»›p</th>
                <th>Quáº» 1</th>
                <th>Quáº» 2</th>
                <th>Quáº» 3</th>
            </tr>
        </thead>
        <tbody id="gvTable"></tbody>
    </table>
</div>

</div>

<!-- ===== POPUP ===== -->
<div class="overlay" id="overlay">
    <div class="popup">
        <h2 id="popupTitle"></h2>
        <p id="popupText"></p>
        <button onclick="closePopup()">ÄÃ³ng quáº»</button>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded",()=>{

const MUST="Viáº¿t má»™t bá»©c thÆ° gá»­i má»™t ngÆ°á»i thÃ¢n trong dá»‹p Táº¿t, ká»ƒ vá» má»™t Ä‘iá»u con biáº¿t Æ¡n hoáº·c má»™t ká»· niá»‡m Ä‘Ã¡ng nhá»›.";

const fortunes=[
"ChÃºc Táº¿t Ã´ng bÃ  báº±ng lá»i nÃ³i hoáº·c viáº¿t tay",
"GiÃºp bá»‘ máº¹ dá»n dáº¹p nhÃ  cá»­a",
"Viáº¿t lá»i chÃºc nÄƒm má»›i cho tháº§y cÃ´",
"LÃ m má»™t viá»‡c tá»‘t Ä‘áº§u nÄƒm",
"Äá»c má»™t cuá»‘n sÃ¡ch trong dá»‹p Táº¿t"
];

const wishes=[
"ChÃºc con nÄƒm má»›i chÄƒm ngoan, há»c giá»i vÃ  nhiá»u niá»m vui ğŸŒ¸",
"ChÃºc con luÃ´n tá»± tin vÃ  khÃ´ng ngá»«ng cá»‘ gáº¯ng ğŸŒ¼",
"ChÃºc con má»™t nÄƒm má»›i bÃ¬nh an, háº¡nh phÃºc ğŸŠ",
"ChÃºc con luÃ´n yÃªu thÆ°Æ¡ng vÃ  sáº» chia ğŸ’–",
"ChÃºc con khá»Ÿi Ä‘áº§u nÄƒm má»›i Ä‘áº§y nÄƒng lÆ°á»£ng tÃ­ch cá»±c âœ¨"
];

const submitLink="https://docs.google.com/forms/d/e/1FAIpQLSdN-hyzi9o04xdtVcEzaklWbLmihyP0tbbTrmTd4sfLVCiPRA/viewform?usp=dialog";

let drawn=[], userKey="", currentFortune="";

const $=id=>document.getElementById(id);

/* ===== LOGIN ===== */
$("loginBtn").onclick=()=>{
    const name=$("name").value.trim();
    const cls=$("class").value;
    if(!name||!cls){alert("Vui lÃ²ng nháº­p Ä‘á»§ thÃ´ng tin");return;}
    userKey=name+"_"+cls;
    drawn=JSON.parse(localStorage.getItem(userKey))||[];
    $("login").style.display="none";
    $("main").style.display="block";
    $("stuName").innerText=name;
    $("stuClass").innerText=cls;
    $("wish").innerText=wishes[Math.floor(Math.random()*wishes.length)];
};

/* ===== GIEO QUáºº ===== */
$("drawBtn").onclick=()=>{
    if(drawn.length>=3)return;

    if(drawn.length===2 && !drawn.includes(MUST)){
        currentFortune=MUST;
    }else{
        let a=fortunes.filter(x=>!drawn.includes(x));
        currentFortune=a[Math.floor(Math.random()*a.length)];
    }

    $("popupTitle").innerText="ğŸ”® Quáº» "+(drawn.length+1);
    $("popupText").innerText=currentFortune;
    $("overlay").classList.add("show");
    firework();
};

/* ===== ÄÃ“NG POPUP ===== */
window.closePopup=()=>{
    $("overlay").classList.remove("show");
    drawn.push(currentFortune);
    localStorage.setItem(userKey,JSON.stringify(drawn));
    render();
};

/* ===== HIá»‚N THá»Š SAU 3 QUáºº ===== */
function render(){
    if(drawn.length<3)return;
    $("results").innerHTML="";
    drawn.forEach((q,i)=>{
        $("results").innerHTML+=`<li><b>Quáº» ${i+1}:</b> ${q}</li>`;
    });
    $("submit").innerHTML=
    `ğŸ“ <a href="${submitLink}" target="_blank" style="color:#ffd700;font-weight:bold">Ná»™p bÃ i táº¡i Ä‘Ã¢y</a>`;
    $("drawBtn").disabled=true;
}

/* ===== PHÃO HOA ===== */
function firework(){
    for(let i=0;i<12;i++){
        const f=document.createElement("div");
        f.className="firework";
        f.style.left=Math.random()*innerWidth+"px";
        f.style.top=innerHeight/2+"px";
        document.body.appendChild(f);
        setTimeout(()=>f.remove(),1000);
    }
}

/* ===== GV MODE ===== */
$("gvBtn").onclick=()=>{
    if(prompt("Máº­t kháº©u giÃ¡o viÃªn")!=="vietschool2026"){
        alert("Sai máº­t kháº©u");
        return;
    }
    $("gvPanel").style.display="block";
    $("gvTable").innerHTML="";
    for(let i=0;i<localStorage.length;i++){
        const k=localStorage.key(i);
        if(!k.includes("_"))continue;
        const [n,c]=k.split("_");
        const d=JSON.parse(localStorage.getItem(k))||[];
        $("gvTable").innerHTML+=`
        <tr>
            <td>${n}</td>
            <td>${c}</td>
            <td>${d[0]||""}</td>
            <td>${d[1]||""}</td>
            <td>${d[2]||""}</td>
        </tr>`;
    }
};

});
</script>

</body>
</html>